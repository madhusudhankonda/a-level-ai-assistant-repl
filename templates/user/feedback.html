{% extends 'base.html' %}

{% block title %}Feedback - A-Level AI Assistant{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card">
                <div class="card-header bg-gradient-purple text-white">
                    <h2 class="mb-0">Share Your Feedback</h2>
                </div>
                <div class="card-body">
                    <p class="lead mb-4">
                        Your feedback helps us improve the A-Level AI Assistant platform. Tell us about issues you've encountered, 
                        features you'd like to see, or share general thoughts about your experience.
                    </p>
                    
                    <form method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
                        {{ form.hidden_tag() }}
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="feedback_type" class="form-label">Feedback Type</label>
                                {{ form.feedback_type(class="form-select") }}
                                {% if form.feedback_type.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.feedback_type.errors %}
                                            {{ error }}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6">
                                <label for="impact_level" class="form-label">Impact Level</label>
                                {{ form.impact_level(class="form-select") }}
                                {% if form.impact_level.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.impact_level.errors %}
                                            {{ error }}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                <div class="form-text">How much does this issue affect your use of the platform?</div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="subject" class="form-label">Subject</label>
                            {{ form.subject(class="form-control", placeholder="Brief title for your feedback") }}
                            {% if form.subject.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.subject.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-text">Example: "Image upload not working" or "Would like to see physics formulas"</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="feedback_text" class="form-label">Your Feedback</label>
                            {{ form.feedback_text(class="form-control", rows=5, placeholder="Please provide details about your feedback, issue, or feature request...") }}
                            {% if form.feedback_text.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.feedback_text.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-text">Please be as specific as possible. For issues, include steps to reproduce.</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="screenshot" class="form-label">Screenshot (optional)</label>
                            {{ form.screenshot(class="form-control") }}
                            {% if form.screenshot.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.screenshot.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-text">Upload a screenshot if it helps explain your feedback (JPG, PNG or GIF only)</div>
                        </div>
                        
                        <div class="mb-3" style="display: none;">
                            <label for="browser_info" class="form-label">Browser Info</label>
                            {{ form.browser_info(class="form-control") }}
                        </div>
                        
                        <div class="mb-4">
                            <div class="form-check">
                                {{ form.email_notification(class="form-check-input") }}
                                <label class="form-check-label" for="email_notification">
                                    Email me when this feedback is addressed
                                </label>
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane me-2"></i>Submit Feedback
                            </button>
                            <a href="{{ url_for('user.index') }}" class="btn btn-outline-secondary">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </a>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="mt-4 text-center">
                <p class="text-muted small">
                    Thank you for taking the time to provide feedback. Your input directly helps us improve the A-Level AI Assistant.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Auto-fill browser info field when page loads
    document.addEventListener('DOMContentLoaded', function() {
        const browserInfoField = document.getElementById('browser_info');
        if (browserInfoField) {
            browserInfoField.value = navigator.userAgent;
        }
    });
</script>
{% endblock %}